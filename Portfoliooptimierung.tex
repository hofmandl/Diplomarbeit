
\chapter{Portfoliooptimierung in kontinuirlicher Zeit mit stochastischer Steuerung und HJB-Gleichungen}
\section{Stochastische Steuerung}


\section{Anwendung auf das Portfolioproblem}
\begin{myDefinition}
 Sei $U:(0,\infty) \rightarrow R$ strikt konkav, stetig differenzierbar und es gelte
\begin{equation}
 \lim U'(x)=\infty, \qquad \lim U'(x)=0.
\end{equation}
Dann nennen wir $U$ eine Nutzenfunktion.
\end{myDefinition}



\begin{myDefinition}
\standardsatz
Wir bezeichen mit
\begin{equation}
 J^0(x,t,\pi,U) = E(U(X_{\pi,x,t}(T))
\end{equation}
den erwarteten Endnutzen durch Verfolgung einer Handestrategie $\pi$ bezüglich $U$.
Die Funktion
\begin{equation}
 V^0(t,x,U) = \sup_{\pi} J^0(x,t,\pi,U)
\end{equation}
heißt Wertfunktion.
\end{myDefinition}
Die Bedeutung der $0$ in der Notation wird in späteren Kapiteln klar werden. 

\begin{mySatz}
Sei $v$ eine Lösung von 
\begin{equation} \label{eq:HJBPortfolio} 
 \underset{\pi \in (a,b)}{\text{max}}  \einhalb \pi^2 \sigma^2 x^2 v_{xx}(t,x) + (r+\pi (\mu-r) x)
v_{x}(t,x) + v_t(t,x)=0  
\end{equation}
mit
\begin{equation}
 v(T,x)=U(x)
\end{equation}
Sei außerdem $p$ ein zulässiger Portfolioprozess mit
\begin{equation} 
  \einhalb p(t,x)^2 \sigma^2 x^2 v_{xx}(t,x) + (r+ p(t,x) (\mu-r) x)
v_{x}(t,x) + v_t(t,x)=0 
\end{equation}

Dann gilt 
\begin{equation}
 V^0(t,x)=v^0(t,x)
\end{equation}
und $p$ ist der optimale Portfolioprozess.
\end{mySatz}


\section{Explizite Lösung für logaritmischen Nutzen}
Wir zeigen, dass die Wertfunktion durch
\begin{equation} \label{eq:LogWertfunktion}
 v^0(t,x)= \log(x)+\left(r + \einhalb \bruch^2 \right) (T-t)
\end{equation}
ist. Dazu berechen wir die Ableitungen
\begin{equation}
 V_t(t,x)= -(r+\frac{1}{2} (\frac{\mu-r}{\sigma})^2,
\end{equation}
\begin{equation}
 V_x(t,x)= \frac{1}{x}
\end{equation}
und
\begin{equation}
 V_x(t,x)= -\frac{1}{x^2}.
\end{equation}
Einsetzen in Korn/Korn, Seite 276 ergibt:
\begin{align*}
 B &= \einhalb \pi^2 \sigma^2 x^2 V_{xx}(t,x) + (r+\pi(b-r)) x V_x(t,x) + V_t(t,x) \\
   &= \einhalb \pi^2 \sigma^2 x^2 \frac{1}{ \cancel{x^2}} + (r+\pi(b-r)) x \frac{1}{x} + -r+\frac{1}{2}
         (\frac{\mu-r}{\sigma})^2\\
  &= -\pi^2\einhalb \sigma^2+\pi(b-r)-\einhalb (\frac{\mu-r}{\sigma})^2 \\
  &= f(\pi) -\einhalb (\frac{\mu-r}{\sigma})^2
\end{align*}
Dabei haben wir in der letzten Gleichung \ref{eq:fvonpi} eingesetzt. Das Maximum von $f$ ist $\einhalb
(\frac{\mu-r}{\sigma})^2$, Maximieren der vorhergehenden Gleichung ergibt also tatsächlich $0$. Ausserdem
erfüllt \ref{eq:LogWertfunktion} auch die Endbedingung: 
\begin{equation}
 V(T,x)= (r+\frac{1}{2} (\frac{\mu-r}{\sigma})^2 (T-T)= \log(x)+0 = \log(x)
\end{equation}

Maximiert wird die Gleichung durch
\begin{equation}
 \pi=\pistern,
\end{equation}
das ist dann der optimale Portfolioprozess.


Zur Probe berechen wir auch noch den besten konstanten Portfoliprozess, dabei erwarten wir natürlich das
gleiche Ergenis. Wir müssen dazu nur das $\pi$ finden, welches \ref{eq:ExpLogUtilityKonst} maximiert. Dazu
setzen wir \ref{eq:fvonpi} in \ref{eq:ExpLogUtilityKonst} ein 

\begin{equation}
 \pi=\pistern,
\end{equation}

\begin{align}
E(log(X(t))) & = log(x)  + (r + \pi(\mu -r)-\frac{1}{2}\pi^2 \sigma^2) t \\
              &= log(x)  +  (r+f(\pi))t 
\end{align}
Und man erkennt das wir das Maximum von $f$ suchen. Das haben wir schon in \ref{eq:pimax} als
\begin{equation}
 \pi=\pistern
\end{equation}
und wir sind in unserer Probe bestätigt worden.