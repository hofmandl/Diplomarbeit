
\chapter{Portfoliooptimierung im Black-Scholes-Modell: Der Ansatz über stochastische Steuerung}
\section{Das Portfoliooptimierungsproblem}
Wir stellen uns nun die Frage, wenn wir ein gegebenes Anfangskapital $x>0$ besitzen, wir wir uns im Black-Scholes-Modell optimal verhalten, also welche Handelstrategie wir
verwenden. Dazu müssen wir erstmal präzise machen, was wir mit optimal meinen. Als Ziel setzen wir uns hier das Errreichen eines optimalen Endvermögens. Um das quantifizieren zu
können, führen wir zunächst den Begriff einer Nutzenfunktion ein.
\begin{myDefinition}
 Sei $U:(0,\infty) \rightarrow R$ strikt konkav, stetig differenzierbar und es gelte
\begin{equation}
 \lim U'(x)=\infty, \qquad \lim U'(x)=0.
\end{equation}
Dann nennen wir $U$ eine Nutzenfunktion.
\end{myDefinition}

Im folgenden geben wir nun ein Funktional an, dass jeder Strategie einen erwarteten Nutzen zuweist. Optimales Verhalten heißt dann, eine Strategie zu wählen, so dass dieses
Funtional maximiert wird.
\begin{myDefinition} \label{def:Standardportfoliooptimierungsproblem}
\standardsatz
Sei $U$ eine Nutzenfunktion und $\pi$ eine Handelstrategie.
Wir bezeichen mit
\begin{equation}
 J^0(x,t,\pi,U) = E(U(X_{\pi,x,t}(T))
\end{equation}
den erwarteten Endnutzen durch Verfolgung von  $\pi$ bezüglich $U$.
Die Aufgabe
\begin{equation}
 \text{maximiere} \qquad J^0(x,t,\pi,U)
\end{equation}
heißt (Standard-) Portfoliooptimierungsproblem.
Die Funktion
\begin{equation}
 V^0(t,x,U) = \sup_{\pi \in \mathcal{A}(t,x)} J^0(x,t,\pi,U)
\end{equation}
heißt Wertfunktion des Portfoliooptimierungsproblem und eine Strategie für die das Surpremum angenommen wird heißt optimale Strategie für $(t,x)$.
\end{myDefinition}
Die Bedeutung der $0$ in der Notation wird in späteren Kapiteln klar werden. Sie wurde hier nur schon in die Notation aufgenommen um die Notation in der ganzen Arbeit konsistent
zu halten. 
\section{Die Lösung des Portfoliooptimierungsproblem}
Mit Methoden der stochastischen Steuerung kann nun gezeigt werden:
\begin{mySatz} \label{th:Verifikationsatz}
\standardsatz 
Sei $v \in C^{1,2}$ und für alle $(t,x)$ gelte 
\begin{equation} \label{eq:HJBPortfolio} 
 \underset{\pi \in (-c,c)}{\text{max}}  \einhalb \pi^2 \sigma^2 x^2 v_{xx}(t,x) + (r+\pi (\mu-r) x)
v_{x}(t,x) + v_t(t,x)=0  
\end{equation}
mit
\begin{equation} \label{eq:HJBEndbedingung}
 v(T,x)=U(x)
\end{equation}
Sei außerdem $p$ ein zulässiger Portfolioprozess sodass für alle $(t,x)$
\begin{equation}  \label{eq:optimaleHandelsstrategie}
  \einhalb p(t,x)^2 \sigma^2 x^2 v_{xx}(t,x) + (r+ p(t,x) (\mu-r) x)
v_{x}(t,x) + v_t(t,x)=0 
\end{equation}
gilt. Dann gilt 
\begin{equation}
 V^0(t,x)=v^0(t,x)
\end{equation}
und $p$ ist der optimale Portfolioprozess.
\end{mySatz}


\section{Explizite Lösung für logaritmischen Nutzen}
Als Anwendung des vorangegangen Satzes berechnen wir das optimale Portfolio und die Wertfunktion für den Fall des logarithmischen Nutzens.
\begin{mySatz}
 Es gilt:
\begin{equation} \label{eq:LogWertfunktion}
 V^0(t,x)= \log(x)+\left(r + \einhalb \bruch^2 \right) (T-t)
\end{equation}
und
\begin{equation*}
 \pistar=\pistern 
\end{equation*}
ist die optimale Strategie.
\end{mySatz}

\begin{proof}
Wir müssen lediglich alle Vorausetzungen von Satz \ref{th:Verifikationsatz} überprüfen.
Zunächst berechen wir die Ableitungen von \eqref{eq:LogWertfunktion}
\begin{align*}
V_t(t,x) &= - \left( r+\frac{1}{2} \bruch^2 \right) \\
V_x(t,x) &= \frac{1}{x} \\
V_x(t,x) &= -\frac{1}{x^2} \\
\end{align*}
Einsetzen in \eqref{eq:HJBPortfolio} ergibt:
\begin{equation*}
\begin{split}
    &\einhalb \pi^2 \sigma^2 x^2 V_{xx}(t,x) + (r+\pi(b-r)) x V_x(t,x) + V_t(t,x) \\
   =&\einhalb \pi^2 \sigma^2 x^2 \frac{1}{x^2} + (r+\pi(b-r)) x \frac{1}{x} + - \left( r+\frac{1}{2} \bruch^2 \right) \\
  =& -\pi^2\einhalb \sigma^2+\pi(b-r)-\einhalb \bruch^2 \\
  = & f(\pi) -\einhalb \bruch^2
\end{split}
\end{equation*}
Dabei haben wir in der letzten Gleichung das f aus \eqref{eq:fvonpi} eingesetzt. Das Maximum von $f$ ist, wir im Satz \ref{th:Eigenschaften_f} angegeben, $\einhalb
\bruch^2$, maximieren der vorhergehenden Gleichung ergibt also tatsächlich $0$. Weiter wissen wir aus Satz \ref{th:Eigenschaften_f}, dass dass Maximum von $f$ in $\pistar$
angenommen wird, also ist auch \eqref{eq:optimaleHandelsstrategie} erfüllt. 
Ausserdem erfüllt \ref{eq:LogWertfunktion} auch die Endbedingung: 
\begin{equation}
 V(T,x)= \log x + \left( r+\frac{1}{2} \bruch^2  \right) (T-T)= \log x +0 = \log(x)
\end{equation}
Damit sind alle Bedingungen von Satz \ref{th:Verifikationsatz} erfüllt und die Behauptung ist bewiesen.
\end{proof}

Die Wertfunktion und die optimale Strategie fallen natürlich nicht vom Himmel. Normalerweise geht man umgekehrt vor und versucht die Differentialgleichung zu lösen. Bei solch
einenm Vorgehen besteht immer die Gefahr, dass man notwendige und hinreichende Bedingungen durcheinander wirft.Wir haben uns hier darauf beschränkt nur die Lösung anzugeben und zu
verifizieren, dass sie tatsächliche die Vorausetzungen erfüllt.


Zur Probe berechen wir auch noch den besten konstanten Portfoliprozess, dabei erwarten wir natürlich das
gleiche Ergenis. Wir müssen dazu nur das $\pi$ finden, welches \ref{eq:ExpLogUtilityKonst} maximiert. Dazu
setzen wir \ref{eq:fvonpi} in \ref{eq:ExpLogUtilityKonst} ein 

\begin{equation}
 \pi=\pistern,
\end{equation}

\begin{align}
E(log(X(t))) & = log(x)  + (r + \pi(\mu -r)-\frac{1}{2}\pi^2 \sigma^2) t \\
              &= log(x)  +  (r+f(\pi))t 
\end{align}
Und man erkennt das wir das Maximum von $f$ suchen. Das haben wir schon in \ref{eq:pimax} als
\begin{equation}
 \pi=\pistern
\end{equation}
und wir sind in unserer Probe bestätigt worden.